schema: '2.0'
stages:
  data_split:
    cmd: python src/data_split.py
    deps:
    - path: data/all_data
      hash: md5
      md5: a508cf300fe07383de3d6286dfeacb9e.dir
      size: 37116084
      nfiles: 400
    - path: src/data_split.py
      hash: md5
      md5: 397a6ec5fc138da13f5067274d4eb21a
      size: 3555
    params:
      params.yaml:
        base:
          random_seed: 0
          model_image_size: 256
          output_channels: 3
          class_weights:
          loss_function: categorical_crossentropy
          metrics:
          - keras_iou
          norm_upper_bound: 7
          norm_lower_bound: -1
          filter_channels:
          - original
          hessian_component: minima
          hessian_sigma: 4
        data_split:
          test_split: 0.2
          data_dir: data/all_data/
          train_data_dir: data/train/
          test_data_dir: data/test/
    outs:
    - path: data/test
      hash: md5
      md5: 10469110fe1d46b13feac438b300d17e.dir
      size: 7377726
      nfiles: 80
    - path: data/train
      hash: md5
      md5: 1944287ff92c08c343cb94c0928b6529.dir
      size: 29738358
      nfiles: 320
  train:
    cmd: python src/train.py
    deps:
    - path: data/train/
      hash: md5
      md5: 1944287ff92c08c343cb94c0928b6529.dir
      size: 29738358
      nfiles: 320
    - path: src/augmentation.py
      hash: md5
      md5: 852c8ac90f90d6528f8388bf2063a92c
      size: 3169
    - path: src/plotting.py
      hash: md5
      md5: c7003cbd72514a5b1941c768980e0a85
      size: 3470
    - path: src/preprocess.py
      hash: md5
      md5: fd4392c44861406d1e64db6f41f8f2b5
      size: 5298
    - path: src/train.py
      hash: md5
      md5: 817bca6bc855d15121a9d7ee1a1b1dd1
      size: 10849
    - path: src/unet.py
      hash: md5
      md5: a21b54a1e05fc92e06a42ac70086ff34
      size: 18613
    params:
      params.yaml:
        base:
          random_seed: 0
          model_image_size: 256
          output_channels: 3
          class_weights:
          loss_function: categorical_crossentropy
          metrics:
          - keras_iou
          norm_upper_bound: 7
          norm_lower_bound: -1
          filter_channels:
          - original
          hessian_component: minima
          hessian_sigma: 4
        train:
          train_data_dir: data/train/
          model_save_dir: models/
          batch_size: 8
          epochs: 10
          activation_function: relu
          learning_rate: 0.001
          validation_split: 0.2
    outs:
    - path: models/unet_model.keras
      hash: md5
      md5: 90a6679409998853a9709cebdd7281f2
      size: 23461063
    - path: results/train/
      hash: md5
      md5: f3116d56b24839573793cf4b4752fbf2.dir
      size: 164852
      nfiles: 8
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/test/
      hash: md5
      md5: 10469110fe1d46b13feac438b300d17e.dir
      size: 7377726
      nfiles: 80
    - path: models/unet_model.keras
      hash: md5
      md5: 90a6679409998853a9709cebdd7281f2
      size: 23461063
    - path: src/evaluate.py
      hash: md5
      md5: ecec2baa5146b63cc772e107d34b0a80
      size: 6155
    - path: src/plotting.py
      hash: md5
      md5: c7003cbd72514a5b1941c768980e0a85
      size: 3470
    - path: src/unet.py
      hash: md5
      md5: a21b54a1e05fc92e06a42ac70086ff34
      size: 18613
    params:
      params.yaml:
        base:
          random_seed: 0
          model_image_size: 256
          output_channels: 3
          class_weights:
          loss_function: categorical_crossentropy
          metrics:
          - keras_iou
          norm_upper_bound: 7
          norm_lower_bound: -1
          filter_channels:
          - original
          hessian_component: minima
          hessian_sigma: 4
        evaluate:
          model_path: models/unet_model.keras
          test_data_dir: data/test/
    outs:
    - path: results/evaluate/
      hash: md5
      md5: 8da07fe9d2ca5fa4313201e95bbded2c.dir
      size: 1055189
      nfiles: 21
